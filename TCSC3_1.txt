1

4.12.2 Initiator

Initiator constructs and sends a TLV-encoded Sigma1 message containing a random initiation value, destination identifier, session identifier, and the public key for its ephemeral key pair.

Responder receives the message.

2

Responder

Responder validates the destination identifier contained in the message.

If the destination identifier matches a candidate destination id (as generated by the process in spec section 4.12.2.4.2), the responder proceeds to generate a Sigma 2 message.

If the destination identifier does not match any candidate destination ids, then the responder sends a SigmaError message with the NoSharedTrustRoots error code and no performs no further processing.

3

Responder

Responder constructs and sends a TLV-encoded Sigma2 message containing a random responder value, responder session id, trusted root id, public key for its responder ephemeral key pair, and encrypted integrity data.

Initiator receives the message.

4

Initiator

Initiator validates that the trusted root id in the message is contained in its list of trusted root ids.

If the trusted root id matches on in the initiatorâ€™s trusted roots list, then it proceeds to the next step to decrypt the integrity data.

If the trusted root id is not found, then the initiator sends a SigmaError message with the NoSharedTrustRoots error code and performs no further processing.

5

Initiator

Initiator decrypts and verifies the message integrity data.

If the verification succeeds, the initiator moves to the next step to send a Sigma3 message.

If the verification fails, the initiator sends a SigmaError message with the InvalidParameter error code.

6

Initiator

Initiator constructs and sends a TLV-encoded Sigma3 message containing encrypted integrity data.

Responder receives the message.

7

Responder

Responder decrypts and verifies the message integrity data.

If the verification succeeds, the session is established.

If the verification fails, the responder sends a SigmaError message with the InvalidParameter error code.
